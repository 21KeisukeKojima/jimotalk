<div class="post-index-wrapper">
  <div class="container">
    <h1 class="text-center">自慢一覧</h1>
    <% @posts.each do |post| %>
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <div class="post-index-single">
            <h2 class="post-author"><%= post.user.name %></h2>
            <div class="post-content"><%= post.content %></div>
            <% if post.image.url %>
              <%= image_tag post.image.url %>
            <% end %>
            <div class="post-menu">
              <ul class="list-unstyled list-inline">
                <li>
                  <div id="likes_buttons_<%= post.id %>">
                    <%= render partial: 'likes/like', locals: {post: post} %>
                  </div>
                </li>
                <li>
                  <%= link_to new_post_comment_path(post_id: post.id), method: :get do %>
                    <span class="fas fa-comment-alt fa-lg menu-btn"></span>
                  <% end %>
                </li>
                <% if post.user_id == current_user.id %>
                  <li>
                    <%= link_to post_destroy_path(id: post.id), method: :delete do %>
                      <span class="fas fa-trash-alt fa-lg menu-btn"></span>
                    <% end %>
                  </li>
                  <li>
                    <%= link_to edit_post_path(id: post.id), method: :get do %>
                      <span class="fas fa-pen fa-lg menu-btn"></span>
                    <% end %>
                  </li>
                <% end %>
              </ul>
            </div>
            <div>
              <h4 class="comment-title">コメント</h4>
              <ul>
                <% post.comments.each do |comment| %>
                  <div class="comment-single">
                    <li class="comment-user"><%= current_user.name %>:</li>
                    <li class="comment-text"><%= comment.content %></li>
                    <li class="comment-delete"><%= link_to "削除", destroy_post_comment_path(post_id: post.id), method: :delete %></li>
                  </div>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      </div>
    <% end %>
    <div class='text-center'><%= paginate @posts %></div>
  </div>
</div>


<script>
  $(function() {
    $('.fa-trash-alt').click(function() {
      if(!confirm('本当に削除しますか？')){
        return false;
      }else{
        location.href = 'index.html';
      }
    });
  });
  
</script>


